<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ChatBhar â€” Social + Messaging</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="bg-orb orb-1"></div>
    <div class="bg-orb orb-2"></div>

    <section id="authGate" class="auth-gate">
      <div class="auth-card glass">
        <div class="brand auth-brand">
          <div class="brand-logo">ğŸ’¬</div>
          <h1>ChatBhar</h1>
        </div>
        <p>Create account or login to continue</p>

        <form id="signupForm" class="auth-form">
          <input id="signupName" type="text" placeholder="Full name" required />
          <input id="signupEmail" type="email" placeholder="Email" required />
          <div class="password-field">
            <input id="signupPassword" type="password" placeholder="Create password" required />
            <button type="button" class="toggle-password" data-target="signupPassword">ğŸ‘ï¸</button>
          </div>
          <div class="password-field">
            <input id="signupConfirmPassword" type="password" placeholder="Confirm password" required />
            <button type="button" class="toggle-password" data-target="signupConfirmPassword">ğŸ‘ï¸</button>
          </div>
          <button type="submit">Sign up</button>
          <p class="auth-toggle">Already have an account? <a href="#" id="showLoginForm">Login instead</a></p>
        </form>

        <form id="loginForm" class="auth-form" hidden>
          <input id="emailInput" type="email" placeholder="Email" required />
          <div class="password-field">
            <input id="passwordInput" type="password" placeholder="Password" required />
            <button type="button" class="toggle-password" data-target="passwordInput">ğŸ‘ï¸</button>
          </div>
          <button type="submit">Login</button>
          <p class="auth-toggle">Don't have an account? <a href="#" id="showSignupForm">Sign up instead</a></p>
        </form>

        <form id="usernameForm" class="auth-form" hidden>
          <div class="form-group">
            <label for="usernameInput">Pick a unique username</label>
            <input id="usernameInput" type="text" placeholder="Create a unique username" required />
            <small id="usernameHint"></small>
          </div>
          <div class="upload-btn-row">
            <button type="button" id="usernameCheckBtn">Check availability</button>
            <button type="submit">Continue</button>
          </div>
        </form>



        <small id="authMessage"></small>
      </div>
    </section>

    <div class="app-shell" id="appShell" hidden>
      <header class="topbar glass">
        <div class="brand">
          <div class="brand-logo">ğŸ’¬</div>
          <h1>ChatBhar</h1>
        </div>
        <div class="top-actions">
          <div id="serverStatus" class="status-dot" title="Checking server..."></div>
          <button id="themeToggle" class="icon-btn" title="Toggle theme">ğŸŒ™</button>
          <button id="deleteAccountOpenBtn" class="admin-btn danger">Delete Account</button>
          <button id="logoutBtn" class="admin-btn">Logout</button>
        </div>
      </header>

      <div class="app-layout">
        <nav class="bottom-nav glass">
          <button class="nav-btn active" data-tab="home">ğŸ <span>Home</span></button>
          <button class="nav-btn" data-tab="explore">ğŸ”<span>Explore</span></button>
          <button class="nav-btn" data-tab="post">â•<span>Post</span></button>
          <button class="nav-btn" data-tab="channels">ğŸ¥<span>Channels</span></button>
          <button class="nav-btn" data-tab="chat">ğŸ’¬<span>Chat</span></button>
        </nav>

        <main>
          <section id="home" class="screen active">
            <div class="search-row glass">
              <span>ğŸ”</span>
              <input placeholder="Search creators, channels, tagsâ€¦" />
            </div>
            <div class="stories glass" id="storiesRow"></div>
            <div id="feedList" class="feed-list"></div>
          </section>

          <section id="explore" class="screen">
            <h2>Explore</h2>
            <p>Search users and discover who is currently active.</p>
            <div class="search-row glass">
              <span>ğŸ”</span>
              <input id="exploreSearchInput" placeholder="Search by name or email..." />
            </div>
            <div id="exploreUsersList" class="explore-users-list"></div>
          </section>

          <section id="post" class="screen">
            <h2>Create Upload</h2>
            <div class="glass upload-type-row" id="uploadTypeRow">
              <button class="type-btn active" data-type="short">Shorts</button>
              <button class="type-btn" data-type="carousel">Carousel Post</button>
              <button class="type-btn" data-type="ltv">Long Video (LTV)</button>
              <button class="type-btn" data-type="story">24h Story</button>
            </div>

            <form id="uploadForm" class="glass upload-form">
              <input id="uploadCaption" type="text" placeholder="Write caption / title" />
              <textarea id="uploadDescription" placeholder="Description"></textarea>
              <input id="uploadFiles" type="file" multiple hidden />

              <div id="uploadDropZone" class="upload-dropzone" role="button" tabindex="0">
                <div class="drop-icon">â˜ï¸</div>
                <p><strong>Click to browse your computer</strong> or drag file(s) here</p>
                <small id="uploadHint">Shorts: 1 video Â· Carousel: multiple images Â· LTV: 1 video Â· Story: image/video (24h)</small>
              </div>

              <div id="uploadSelectedPreview" class="upload-selected-preview"></div>

              <div class="upload-btn-row">
                <button type="button" id="openCreativeSuite">Creative Suite</button>
                <button type="button" id="clearUploadSelection">Cancel</button>
                <button type="submit" id="publishUploadBtn">Create post</button>
              </div>
            </form>

            <div id="uploadStatus" class="status-text"></div>
            <div class="upload-progress" id="uploadProgressWrap" hidden><div id="uploadProgressBar"></div></div>
            <div id="uploadList" class="upload-list"></div>
          </section>

          <section id="channels" class="screen">
            <div class="profile-header">
              <div class="profile-header-top">
                <div class="profile-avatar" id="myChannelAvatar">U</div>
                <div class="profile-info">
                  <div class="profile-username-row">
                    <h2 id="myChannelHandle">Username</h2>
                    <button class="edit-profile-btn">Edit Profile</button>
                    <button class="settings-btn icon-btn">âš™ï¸</button>
                  </div>
                  <div class="profile-stats">
                    <span><strong id="myPostCount">0</strong> posts</span>
                    <span><strong id="myFollowerCount">128</strong> followers</span>
                    <span><strong id="myFollowingCount">256</strong> following</span>
                  </div>
                  <div class="profile-bio">
                    <strong id="myChannelDisplayName" style="font-size: 16px;">Full Name</strong>
                    <span id="myChannelProfession" style="color: var(--muted); display: block; margin-bottom: 4px;">Content Creator</span>
                    <p id="myChannelBio">Digital Creator | Tech Enthusiast | Travel Lover ğŸŒ</p>
                    <div id="myChannelLocation" style="margin-top: 8px; font-size: 0.85rem;">
                      ğŸ“ <span>India</span>
                    </div>
                    <div id="myChannelSocialLinks" class="profile-social-links" style="margin-top: 10px; display: flex; gap: 12px;">
                      <!-- Links injected via JS -->
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="profile-tabs">
              <button class="profile-tab active" data-profile-tab="posts">â–¦ POSTS</button>
              <button class="profile-tab" data-profile-tab="videos">ğŸ“º VIDEOS</button>
              <button class="profile-tab" data-profile-tab="saved">ğŸ”– SAVED</button>
              <button class="profile-tab" data-profile-tab="tagged">ğŸ‘¤ TAGGED</button>
              <button class="profile-tab" data-profile-tab="analytics" id="analyticsTabBtn">ğŸ“ˆ ANALYTICS</button>
            </div>

            <div id="channelContentGrid" class="profile-content-grid"></div>

            <div id="analyticsSection" class="analytics-section" hidden>
              <div class="analytics-overview">
                <div class="analytics-card glass">
                  <h4>Total Reach</h4>
                  <div class="value" id="statReach">0</div>
                  <div class="trend up">â†‘ 12% vs last month</div>
                </div>
                <div class="analytics-card glass">
                  <h4>Engagement</h4>
                  <div class="value" id="statEngagement">0%</div>
                  <div class="trend up">â†‘ 5.4%</div>
                </div>
                <div class="analytics-card glass">
                  <h4>Total Shares</h4>
                  <div class="value" id="statShares">0</div>
                  <div class="trend down">â†“ 2%</div>
                </div>
              </div>

              <div class="analytics-charts">
                <div class="chart-container glass">
                  <h4>Weekly Performance</h4>
                  <div class="bar-chart" id="weeklyChart">
                    <!-- Bars injected via JS -->
                  </div>
                </div>
              </div>
            </div>

            <div id="channelContentList" class="channel-content-list" hidden></div>
          </section>

          <section id="chat" class="screen">
            <div class="chat-layout glass">
              <aside class="chat-list">
                <div id="followRequestsSection" hidden>
                  <h3>Follow Requests</h3>
                  <div id="followRequestsList" class="follow-requests-list"></div>
                  <hr style="border: 0; border-top: 1px solid var(--border); margin: 10px 0;" />
                </div>
                <h3>Messages</h3>
                <div id="chatUsersWrap"></div>
                <div class="chat-list-actions">
                  <button id="selectContactBtn" class="utility-btn">Select Contact</button>
                  <button id="createGroupBtn" class="utility-btn">Create Group</button>
                </div>
              </aside>
              <section class="chat-panel">
                <div class="chat-header">
                  <h3 id="activeChatTitle">General</h3>
                  <small id="typingIndicator" class="typing-indicator"></small>
                  <div class="menu-wrap">
                    <button id="chatMenuBtn" class="utility-btn">â‹®</button>
                    <div id="chatMenu" class="chat-menu" hidden>
                      <button id="backupNowBtn">Export backup</button>
                      <button id="importBackupBtn">Import backup</button>
                      <button id="shareBackupBtn">Save to phone</button>
                      <button id="deleteChatBtn" class="danger">Delete current chat</button>
                    </div>
                  </div>
                </div>
                <div id="messages" class="messages"></div>
                <div id="replyPreviewWrap" class="reply-preview-wrap glass" hidden>
                  <div class="reply-preview-content">
                    <strong id="replyUserName">Name</strong>
                    <p id="replyText">Message text...</p>
                  </div>
                  <button id="closeReplyBtn" class="icon-btn">âœ•</button>
                </div>
                <div id="attachmentPreview" class="attachment-preview" hidden></div>
                <input id="backupInput" type="file" accept="application/json" hidden />
                <form id="chatForm" class="composer">
                  <label class="attach-btn" for="fileInput">ğŸ“</label>
                  <input id="fileInput" type="file" multiple />
                  <input id="messageInput" type="text" placeholder="Type a message" />
                  <label class="view-once-toggle" title="View once image"><input id="viewOnceToggle" type="checkbox" /> 1x</label>
                  <button type="submit">Send</button>
                </form>
              </section>
            </div>
          </section>
        </main>

        <aside class="web-sidepanel glass">
          <h3>ChatBhar Web</h3>
          <p>Fast CMS + channels management with lazy-loaded feed.</p>
        </aside>
      </div>
    </div>

    <div id="storyViewer" class="story-viewer" hidden>
      <div class="story-viewer-card glass">
        <div class="story-viewer-top">
          <strong id="storyViewerUser">Story</strong>
          <button id="closeStoryViewer" class="icon-btn">âœ•</button>
        </div>
        <div id="storyViewerMedia" class="story-viewer-media"></div>
        <div class="story-viewer-actions">
          <button id="prevStory">â† Prev</button>
          <button id="nextStory">Next â†’</button>
        </div>
      </div>
    </div>

    <div id="creativeSuiteModal" class="modal" hidden>
      <div class="modal-card glass">
        <div class="modal-top">
          <h3>Creative Suite</h3>
          <button id="closeCreativeSuite" class="icon-btn">âœ•</button>
        </div>
        <div class="suite-grid">
          <aside id="suiteAssetList" class="suite-asset-list"></aside>
          <section>
            <div id="suitePreview" class="suite-preview"></div>
            <div class="suite-controls">
              <label>Trim Start (s)<input id="trimStartInput" type="number" min="0" step="0.1" /></label>
              <label>Trim End (s)<input id="trimEndInput" type="number" min="0" step="0.1" /></label>
              <label>Overlay Text<input id="overlayTextInput" type="text" placeholder="Add text" /></label>
              <label>Text Color<input id="overlayColorInput" type="color" value="#ffffff" /></label>
            </div>
          </section>
        </div>
        <div class="upload-btn-row">
          <button id="saveCreativeSuite" type="button">Save edits</button>
        </div>
      </div>
    </div>

    <div id="postViewer" class="modal" hidden>
      <div class="modal-card glass post-viewer-card">
        <div class="modal-top">
          <h3 id="postViewerTitle">Post</h3>
          <button id="closePostViewer" class="icon-btn">âœ•</button>
        </div>
        <div id="postViewerMedia" class="post-viewer-media"></div>
        <div id="postViewerInteraction" class="post-interaction"></div>
      </div>
    </div>

    <div id="confirmModal" class="modal" hidden>
      <div class="modal-card glass confirm-card">
        <p id="confirmMessage">Are you sure?</p>
        <div class="upload-btn-row">
          <button id="confirmCancel" type="button">Cancel</button>
          <button id="confirmOk" type="button">Delete</button>
        </div>
      </div>
    </div>

    <div id="imagePreviewModal" class="modal" hidden>
      <div class="modal-card glass post-viewer-card">
        <div class="modal-top">
          <h3>Preview image before sending</h3>
          <button id="closeImagePreview" class="icon-btn">âœ•</button>
        </div>
        <div id="imagePreviewBody" class="post-viewer-media"></div>
        <div class="upload-btn-row">
          <button id="imagePreviewCancel" type="button">Cancel</button>
          <button id="imagePreviewSend" type="button">Send image</button>
        </div>
      </div>
    </div>

    <div id="contactModal" class="modal" hidden>
      <div class="modal-card glass confirm-card">
        <div class="modal-top"><h3>Select Contact</h3><button id="closeContactModal" class="icon-btn">âœ•</button></div>
        <div id="contactList" class="contact-list"></div>
      </div>
    </div>

    <div id="groupModal" class="modal" hidden>
      <div class="modal-card glass confirm-card">
        <div class="modal-top"><h3>Create Group</h3><button id="closeGroupModal" class="icon-btn">âœ•</button></div>
        <input id="groupNameInput" placeholder="Group name" />
        <div id="groupContactList" class="contact-list"></div>
        <div class="upload-btn-row"><button id="createGroupConfirm" type="button">Create Group</button></div>
      </div>
    </div>

    <div id="deleteAccountModal" class="modal" hidden>
      <div class="modal-card glass">
        <div class="modal-top">
          <h3>Permanent Account Deletion</h3>
          <button id="closeDeleteModal" class="icon-btn">âœ•</button>
        </div>
        <div class="delete-flow-content">
          <p class="suggestion-note">Maybe <a href="#" id="deactivateInstead">deactivate your account instead</a> of deleting?</p>
          <div class="warning-box">
            <strong>âš ï¸ Final Notice:</strong>
            <p>Your channel data like posts, shorts, long videos will be permanently deleted from our side.</p>
          </div>
          <div class="password-field" style="margin-top: 1rem;">
            <input id="deleteConfirmPassword" type="password" placeholder="Confirm your password to proceed" />
            <button type="button" class="toggle-password" data-target="deleteConfirmPassword">ğŸ‘ï¸</button>
          </div>
          <label class="confirm-checkbox">
            <input type="checkbox" id="deleteTick" />
            <span>I understand that this action is irreversible.</span>
          </label>
        </div>
        <div class="upload-btn-row">
          <button id="cancelDeleteBtn" type="button">Cancel</button>
          <button id="confirmDeleteBtn" class="danger" disabled>Delete Permanently</button>
        </div>
      </div>
    </div>

    <div id="shareModal" class="modal" hidden>
      <div class="modal-card glass confirm-card">
        <div class="modal-top">
          <h3>Share to Chat</h3>
          <button id="closeShareModal" class="icon-btn">âœ•</button>
        </div>
        <div class="contact-list" id="shareContactList">
          <!-- Populated by JS -->
        </div>
        <div class="upload-btn-row">
          <button id="cancelShareBtn" type="button">Cancel</button>
        </div>
      </div>
    </div>

    <div id="editProfileModal" class="modal" hidden>
      <div class="modal-card glass confirm-card">
        <div class="modal-top">
          <h3>Edit Profile</h3>
          <button id="closeEditProfile" class="icon-btn">âœ•</button>
        </div>
        <form id="editProfileForm" class="upload-form">
          <div class="profile-avatar-upload">
            <div class="profile-avatar" id="editProfileAvatarPreview">U</div>
            <input type="file" id="profilePicInput" accept="image/*" hidden />
            <button type="button" id="changeProfilePicBtn" class="edit-profile-btn">Change Photo</button>
          </div>

          <div class="form-group">
            <label for="editProfileUsername">Username</label>
            <input id="editProfileUsername" type="text" placeholder="Username" required />
            <small id="usernameAvailabilityHint"></small>
          </div>

          <div class="form-group">
            <label for="editProfileName">Full Name</label>
            <input id="editProfileName" type="text" placeholder="Full Name" required />
          </div>

          <div class="form-group">
            <label for="editProfileProfession">Category / Profession</label>
            <input id="editProfileProfession" type="text" placeholder="e.g. Content Creator" />
          </div>

          <div class="form-group">
            <label for="editProfileBio">Bio</label>
            <textarea id="editProfileBio" placeholder="Bio"></textarea>
          </div>

          <div class="form-group">
            <label for="editProfileLocation">Location</label>
            <input id="editProfileLocation" type="text" placeholder="e.g. India" />
          </div>

          <div class="form-group">
            <label>Social Links</label>
            <input id="editProfileTwitter" type="url" placeholder="Twitter URL" />
            <input id="editProfileLinkedin" type="url" placeholder="LinkedIn URL" />
            <input id="editProfileGithub" type="url" placeholder="GitHub URL" />
          </div>

          <label class="confirm-checkbox">
            <input type="checkbox" id="editProfilePrivate" />
            <span>Private Account</span>
          </label>

          <div class="upload-btn-row">
            <button id="cancelEditProfile" type="button">Cancel</button>
            <button type="submit" id="saveProfileBtn">Save Changes</button>
          </div>
        </form>
      </div>
    </div>

    <div id="msgContextMenu" class="msg-context-menu" hidden>
      <div class="emoji-bar glass">
        <button data-emoji="ğŸ‘">ğŸ‘</button>
        <button data-emoji="â¤ï¸">â¤ï¸</button>
        <button data-emoji="ğŸ˜‚">ğŸ˜‚</button>
        <button data-emoji="ğŸ˜®">ğŸ˜®</button>
        <button data-emoji="ğŸ˜¢">ğŸ˜¢</button>
        <button data-emoji="ğŸ™">ğŸ™</button>
      </div>
      <div class="menu-actions glass">
        <button id="contextReplyBtn">Reply</button>
        <button id="deleteMeBtn">Delete for Me</button>
        <button id="deleteEveryoneBtn" hidden>Delete for Everyone</button>
      </div>
    </div>

    <script src="app.js"></script>
  </body>
</html>
